---
title: "Ordination with vegan"
author: "Naupaka Zimmerman and Gavin Simpson"
date: "August 9, 2014 â€¢ ESA 2014"
bibliography: ordination.bib

output:
  ioslides_presentation:
    widescreen: true
    smaller: false
    keep_md: true
    highlight: tango
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(comment = "", cache = TRUE)
```

<!----------------------------slide boundary--------------------------------->

# Ordination plots

<!----------------------------slide boundary--------------------------------->

## Unconstrained ordination

**What does it mean?**

* First we look for major variation, then try to attribute it to environmental variation
* vs. constrained ordination, where we only want to see what can be explained by environmental variables of interest

<!----------------------------slide boundary--------------------------------->

## Unconstrained ordination

**What does it mean?**

* First we look for major variation, then try to attribute it to environmental variation
* vs. constrained ordination, where we only want to see what can be explained by environmental variables of interest

**Examples of unconstrained ordination:**

* Principal Components Analysis - PCA
* Nonmetric Multidimensional Scaling - NMDS

<!----------------------------slide boundary--------------------------------->

## Unconstrained ordination

**What does it mean?**

* First we look for major variation, then try to attribute it to environmental variation
* vs. constrained ordination, where we only want to see what can be explained by environmental variables of interest

**Examples of unconstrained ordination:**

* Principal Components Analysis - PCA
* **Nonmetric Multidimensional Scaling - NMDS**

<!----------------------------slide boundary--------------------------------->

## Before we get started

Housekeeping
```{r, eval=FALSE}
setwd("your/working/dir")
```

```{r, results='hide'}
library("vegan")
data(dune)
data(dune.env)
```
Data from : Jongman, R.H.G, ter Braak, C.J.F & van Tongeren, O.F.R. (1987). Data Analysis in Community and Landscape Ecology. Pudoc, Wageningen.

<!----------------------------slide boundary--------------------------------->

## Before we get started

```{r}
head(dune[,1:10], n=3)
```

<!----------------------------slide boundary--------------------------------->

## Before we get started

```{r}
head(dune.env, n=3)
```

<!----------------------------slide boundary--------------------------------->

## Basic ordination and plotting

There are two more basic NMDS ordination functions:

* `isoMDS()` from the MASS package
* `monoMDS()` in vegan

Vegan also has a wrapper function for doing NMDS ordinations using best practices:

* `metaMDS()`

<!----------------------------slide boundary--------------------------------->

## Basic ordination and plotting

```{r, results='hide'}
dune.bray.ord <- metaMDS(dune, distance = "bray", k = 2, trymax = 50)
```

**Show in RStudio**

<!----------------------------slide boundary--------------------------------->

## Basic ordination and plotting (using all defaults)

```{r, fig.height=5}
plot(dune.bray.ord)
```


<!----------------------------slide boundary--------------------------------->

## Basic ordination and plotting (just plots)

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites")
```

<!----------------------------slide boundary--------------------------------->

## Basic ordination and plotting (just species)

```{r, fig.height=5}
plot(dune.bray.ord, display = "species")
```

<!----------------------------slide boundary--------------------------------->

## Site names instead of points

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", type = "t")
```

<!----------------------------slide boundary--------------------------------->

## Larger points

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", cex=2)
```

<!----------------------------slide boundary--------------------------------->

## Modifying the display of the points with environmental data 

* Color
    * Discrete
    * Continuous
* Shape
* Size


<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
# Just points
plot(dune.bray.ord, display = "sites", cex=2)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", cex=2)
ordihull(dune.bray.ord,groups = dune.env$Management, label = TRUE)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", cex=2)
ordihull(dune.bray.ord,groups = dune.env$Management, label = TRUE, col = "blue")
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", cex=2)
ordihull(dune.bray.ord,groups = dune.env$Management, label = TRUE, col = "blue")
ordispider(dune.bray.ord,groups = dune.env$Management, label = TRUE)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, display = "sites", cex=2)
ordispider(dune.bray.ord,groups = dune.env$Management, label = TRUE)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, type = "n")
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, type = "n")
points(dune.bray.ord,display = "sites", cex = 2)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

```{r, fig.height=5}
plot(dune.bray.ord, type = "n")
points(dune.bray.ord,display = "sites", cex = 2)
ordispider(dune.bray.ord,groups = dune.env$Management, label = TRUE)
```

<!----------------------------slide boundary--------------------------------->

## Adding other layers

<!----------------------------slide boundary--------------------------------->

## Fitting environmental data to vectors in ordination space

<!----------------------------slide boundary--------------------------------->

## Fitting environmental data to vectors in ordination space


<!----------------------------slide boundary--------------------------------->

## References
